{% extends 'layout.html' %} {% block classpost %}
<div class="posts-home">
  {% endblock %} {% block modulo %}
  <title>Geekia | Home</title>

  <table class="posts-table-home">
    {% for article in articles|reverse %}
    <tr>
      <td>
        <div class="border-bug-fixer">
          <div class="grid-single-post-container">
            <div class="like-td">
              <form>
                <i
                  id="arrow-up-{{ article.id }}"
                  value="like"
                  onclick="like{{ article.id }}()"
                  class="fad fa-arrow-alt-square-up fa-2x"
                ></i>
              </form>
              <p
                id="likes-{{ article.id }}"
                style="margin-top: 0; margin-bottom: 0;"
              >
                {{ article.likes }}
              </p>
              <form>
                <i
                  id="arrow-down-{{ article.id }}"
                  value="dislike"
                  onclick="dislike{{ article.id }}()"
                  class="fad fa-arrow-alt-square-down fa-2x"
                ></i>
              </form>
            </div>
            <script>
              function like{{ article.id }}() {
                $.ajax({
                  data: {
                    id_articolo: '{{ article.id }}',
                    type: '+',
                    user_id: '{{ session["user_id"] }}'
                  },
                  type: 'POST',
                  url: '/articoli'
                })
                .done(function(data){ if (data.output == 'good') document.getElementById('likes-{{ article.id }}').innerHTML = data.newVal; });
                event.preventDefault();
              	document.getElementById("arrow-up-{{article.id}}").classList.toggle("arrow-up-clicked")
                if (document.getElementById("arrow-up-{{article.id}}").classList.contains("arrow-up-clicked") && document.getElementById("arrow-down-{{article.id}}").classList.contains("arrow-down-clicked"))
                  document.getElementById("arrow-down-{{article.id}}").classList.remove("arrow-down-clicked")
              }
              function dislike{{ article.id }}() {
                $.ajax({
                  data: {
                    id_articolo: '{{ article.id }}',
                    type: '-',
                    user_id: '{{ session["user_id"] }}'
                  },
                  type: 'POST',
                  url: '/articoli'
                })
                .done(function(data){ if (data.output == 'good') document.getElementById('likes-{{ article.id }}').innerHTML = data.newVal; });
                event.preventDefault();
              	document.getElementById("arrow-down-{{article.id}}").classList.toggle("arrow-down-clicked")
                if (document.getElementById("arrow-down-{{article.id}}").classList.contains("arrow-down-clicked") && document.getElementById("arrow-up-{{article.id}}").classList.contains("arrow-up-clicked"))
                  document.getElementById("arrow-up-{{article.id}}").classList.remove("arrow-up-clicked")
              }
            </script>
            <div
              onclick="window.location='/articoli/{{ article.id }}'"
              class="post-table-central-text"
            >
              <h2>{{ article.titolo }}</h2>
              <h4>
                Caricato da {{ article.autore.nome }} il {{ article.data }}
              </h4>
            </div>
            {% if session['permessi'] == 4 %} {% if session['darkMode'] == True
            %}
            <div
              onclick="window.location='/del/{{ article.id }}'"
              style="color: #eee; font-size: 25px; align-self: center;"
            >
              <i class="fas fa-trash-alt" aria-hidden="true"></i>
            </div>
            {% else %}
            <div
              onclick="window.location='/del/{{ article.id }}'"
              style="color: #222; font-size: 25px; align-self: center;"
            >
              <i class="fas fa-trash-alt" aria-hidden="true"></i>
            </div>
            {% endif %} {% endif %}

            <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 30" x="0px" y="0px"><path fill-rule="evenodd" d="M23,7.44365081 L23,16.5563492 L16.5563492,23 L7.44365081,23 L1,16.5563492 L1,7.44365081 L7.44365081,1 L16.5563492,1 L23,7.44365081 Z M15.7279221,3 L8.27207794,3 L3,8.27207794 L3,15.7279221 L8.27207794,21 L15.7279221,21 L21,15.7279221 L21,8.27207794 L15.7279221,3 Z M7,11 L17,11 L17,13 L7,13 L7,11 Z"/></svg> -->
          </div>
        </div>
      </td>
    </tr>
    {% endfor %}
  </table>

  {% endblock %}
</div>
